---
title: "Merge"
output: html_document
date: "2023-02-20"
---


```{r}
library(ggplot2)

concat_track_table = read.csv("/home/enrique/Escritorio/Master/TFM/Muestras/Estudios/track_tables_finales/concat_track_table.tsv", sep = "\t")
presence_absence_species_table = read.csv("/home/enrique/Escritorio/Master/TFM/Muestras/Estudios/Scripts_EukDetect/presence_absence_table/presence_absence_species_table.tsv", sep = "\t")

presence_absence_species_table$Sum = rowSums(presence_absence_species_table[, -1])

# Calcular el valor máximo Y mínimo de la columna Sum
maximo_valor = max(presence_absence_species_table$Sum)
minimo_valor = min(presence_absence_species_table$Sum)

# Seleccionar las columnas de interés
track_table_fi = concat_track_table[, c(1, 4)]
conteos_fi = presence_absence_species_table[, c("Sample", "Sum")]

# Calcular el valor máximo de la columna bowtie
maximo_valor = max(concat_track_table$bowtie)
minimo_valor = min(concat_track_table$bowtie)

#Juntar la track_table final con el recuento de lecturas de Bowtie junto con la suma total de taxones encontrados por muestra
merge = merge(track_table_fi, conteos_fi, by = "Sample")

# Crear el gráfico de puntos con ggplot2
ggplot(merge, aes(x = merge$Sum, y = merge$bowtie)) +
  geom_point(color = "blue", size = 3) +
  labs(title = "Gráfico de Puntos", x = "Coordenada X", y = "Coordenada Y") +
  theme_minimal()


```